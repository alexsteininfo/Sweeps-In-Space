#   color = guide_legend(
#     ncol = 2,
#     byrow = TRUE,   # fills row-wise (usually nicer)
#     override.aes = list(size = 4)
#   )
# )
)
source("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/legend_plots.R", echo = TRUE)
source("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/multiple_sweeps.R", echo = TRUE)
source("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/sweeps_random.R", echo = TRUE)
source("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_4/Sweep_sim.R", echo = TRUE)
# --- Plot ---
fig <- ggplot() +
# prediction lines
geom_line(aes(x = 2:20,  y = df_num$twodim, color = pred_1, linetype = pred_1),
linewidth = 1.5) +
geom_line(aes(x = xaxis, y = sweep_ana,     color = pred_2, linetype = pred_2),
linewidth = 1.5) +
# simulation points (shape mapped -> legend)
geom_point(aes(x = x_data, y = y_data1, shape = sim_1), size = 4, colour = "black") +
geom_point(aes(x = x_data, y = y_data2, shape = sim_2), size = 4, colour = "black") +
geom_point(aes(x = x_data, y = y_data3, shape = sim_3), size = 4, colour = "black") +
# IMPORTANT: use VALUES only (breaks optional)
scale_color_manual(values = colours) +
scale_linetype_manual(values = linetypes) +
scale_shape_manual(values = shapes) +
# if you want ordering, add breaks AFTER it works:
# scale_color_manual(values = colours, breaks = c(pred_1, pred_2)) +
# scale_linetype_manual(values = linetypes, breaks = c(pred_1, pred_2)) +
# scale_shape_manual(values = shapes, breaks = c(sim_1, sim_2, sim_3)) +
labs(x = "ratio of fitness difference, *a<sub>m</sub>* / *a<sub>wt</sub>*",
y = "Pr(sweep)") +
coord_cartesian(xlim = c(1, 20), ylim = c(0, 1)) +
theme_bw(base_size = 25) +
theme(
axis.title.x = element_markdown(),
axis.title.y = element_markdown(),
legend.text  = element_markdown(),
legend.title = element_blank(),
legend.position = c(0.75, 0.3),
legend.box.spacing = grid::unit(0, "pt"),
legend.spacing.y   = grid::unit(0, "pt"),
legend.box.margin  = margin(0, 0, 0, 0),
legend.margin      = margin(0, 0, 0, 0)
)
a=1.5
ggsave(paste(pathtosave,"sweeps_validate.pdf", sep=""), fig, width = 4^a, height = 3^a)
ggsave(paste(pathtosave,"sweeps_validate.pdf", sep=""), fig, device = cairo_pdf, width = 4^a, height = 3^a)
install.packages("Cairo")
library(Cairo)
ggsave(paste(pathtosave,"sweeps_validate.pdf", sep=""), fig, device = cairo_pdf, width = 4^a, height = 3^a)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
library(ggplot2)
library(RColorBrewer)
library(ggtext)
# --- Internal keys for mapping (plain ASCII; these are NOT shown) ---
sim_k1 <- "sim_1e-4"
sim_k2 <- "sim_1e-5"
sim_k3 <- "sim_1e-6"
pred_1 <- "prediction (exact)"
pred_2 <- "prediction (approx.)"
# --- Manual scales (named vectors) ---
cols <- brewer.pal(12, "Paired")
colours   <- setNames(c(cols[4], cols[3]), c(pred_1, pred_2))
linetypes <- setNames(c("22", "solid"),     c(pred_1, pred_2))
shapes    <- setNames(c(16, 17, 18),        c(sim_k1, sim_k2, sim_k3))
# --- Plot ---
fig <- ggplot() +
# prediction lines
geom_line(aes(x = 2:20,  y = df_num$twodim, color = pred_1, linetype = pred_1),
linewidth = 1.5) +
geom_line(aes(x = xaxis, y = sweep_ana,     color = pred_2, linetype = pred_2),
linewidth = 1.5) +
# simulation points (shape mapped -> legend)
geom_point(aes(x = x_data, y = y_data1, shape = sim_k1), size = 4, colour = "black") +
geom_point(aes(x = x_data, y = y_data2, shape = sim_k2), size = 4, colour = "black") +
geom_point(aes(x = x_data, y = y_data3, shape = sim_k3), size = 4, colour = "black") +
scale_color_manual(values = colours) +
scale_linetype_manual(values = linetypes) +
scale_shape_manual(
values = shapes,
breaks = c(sim_k1, sim_k2, sim_k3),
labels = c(
bquote("simulations, " * tilde(mu) == 10^{-4}),
bquote("simulations, " * tilde(mu) == 10^{-5}),
bquote("simulations, " * tilde(mu) == 10^{-6})
)
) +
labs(
x = "ratio of fitness difference, *a<sub>m</sub>* / *a<sub>wt</sub>*",
y = "Pr(sweep)"
) +
coord_cartesian(xlim = c(1, 20), ylim = c(0, 1)) +
theme_bw(base_size = 25) +
theme(
axis.title.x = element_markdown(),
axis.title.y = element_markdown(),
legend.title = element_blank(),
legend.text  = element_text(),   # IMPORTANT: expressions need element_text()
legend.position = c(0.75, 0.3),
legend.box.spacing = grid::unit(0, "pt"),
legend.spacing.y   = grid::unit(0, "pt"),
legend.box.margin  = margin(0, 0, 0, 0),
legend.margin      = margin(0, 0, 0, 0)
)
a <- 1.5
ggsave(paste0(pathtosave, "sweeps_validate.pdf"), fig, width = 4^a, height = 3^a)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
# --- Plot ---
fig <- ggplot() +
# prediction lines
geom_line(aes(x = 2:20,  y = df_num$twodim, color = pred_1, linetype = pred_1),
linewidth = 1.5) +
geom_line(aes(x = xaxis, y = sweep_ana,     color = pred_2, linetype = pred_2),
linewidth = 1.5) +
# simulation points (shape mapped -> legend)
geom_point(aes(x = x_data, y = y_data1, shape = sim_k1), size = 4, colour = "black") +
geom_point(aes(x = x_data, y = y_data2, shape = sim_k2), size = 4, colour = "black") +
geom_point(aes(x = x_data, y = y_data3, shape = sim_k3), size = 4, colour = "black") +
scale_color_manual(values = colours) +
scale_linetype_manual(values = linetypes) +
scale_shape_manual(
values = shapes,
breaks = c(sim_k1, sim_k2, sim_k3),
labels = c(
expression(paste("simulations, ", italic(tilde(mu)), "=", 10^{-4})),,
bquote("simulations, " * italic(tilde(mu)) == 10^{-5}),
bquote("simulations, " * italic(tilde(mu)) == 10^{-6})
)
) +
labs(
x = "ratio of fitness difference, *a<sub>m</sub>* / *a<sub>wt</sub>*",
y = "Pr(sweep)"
) +
coord_cartesian(xlim = c(1, 20), ylim = c(0, 1)) +
theme_bw(base_size = 25) +
theme(
axis.title.x = element_markdown(),
axis.title.y = element_markdown(),
legend.title = element_blank(),
legend.text  = element_text(),   # IMPORTANT: expressions need element_text()
legend.position = c(0.75, 0.3),
legend.box.spacing = grid::unit(0, "pt"),
legend.spacing.y   = grid::unit(0, "pt"),
legend.box.margin  = margin(0, 0, 0, 0),
legend.margin      = margin(0, 0, 0, 0)
)
a <- 1.5
ggsave(paste0(pathtosave, "sweeps_validate.pdf"), fig, width = 4^a, height = 3^a)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_4/Sweep_sim.R", echo = TRUE)
fig
setwd("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/data/Revised_sims_used/")
#sweeps2 <- read_csv("simulation_data_s015/sweeps-all.csv")
sweeps <- read_csv("sweeps_all/unlimited/s 005 unlimited/sweeps-all.csv")
source("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/multiple_sweeps.R", echo = TRUE)
print(g2)
print(g3)
ggsave("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/figures/multiple_sweeps.pdf", g3, width = 4^a, height = 3^a)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.1,0.5)
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.1,0.5),
legend.title = "none"
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.1,0.5),
legend.title = element_blank()
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.1,0.8),
legend.title = element_blank()
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.15,0.7),
legend.title = element_blank()
)
print(g3)
ggsave("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/figures/multiple_sweeps.pdf", g3, width = 4^a, height = 3^a)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank()
)
print(g3)
ggsave("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/figures/multiple_sweeps.pdf", g3, width = 4^a, height = 3^a)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank(),
legend.margins = 0.01
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank(),
legend.margin = 0.1
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank(),
legend.margin = margin(0, 0, 0, 0)
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank(),
legend.margin = margin(0.1, 0.1, 0.1, 0.1)
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank(),
legend.margin = margin(0.5, 0.1, 0.1, 0.1)
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank(),
legend.margin = margin(0.5, 0.1, 0.1, 0.1)
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank(),
legend.margin = margin(2.5, 0.1, 0.1, 0.1)
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.12,0.7),
legend.title = element_blank(),
legend.margin = margin(2.0, 2.0, 2.0, 2.0)
)
print(g3)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.10,0.70),
legend.title = element_blank(),
legend.margin = margin(2.0, 2.0, 2.0, 2.0)
)
print(g3)
ggsave("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/figures/multiple_sweeps.pdf", g3, width = 4^a, height = 3^a)
# Step 2: Create the stacked area plot - s tilde version
g3<-ggplot(df_summary, aes(x = factor(s_tilde), y = proportion_post_adjustment, fill = factor(SweepCount))) +
geom_bar(stat = "identity") +
scale_fill_manual(values = sweep_colors) +
labs(
x = expression("mean effect of surviving mutations, " * italic(tilde(s))),
y = "proportion",
fill = "Number of Sweeps"
) +
theme_bw(base_size = 25) +
theme(
axis.text.x = element_text(size = 14), #angle = 45, hjust = 1),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 25),
legend.position = c(0.10,0.72),
legend.title = element_blank(),
legend.margin = margin(2.0, 2.0, 2.0, 2.0)
)
print(g3)
ggsave("~/Documents/GitHub/Sweeps-In-Space/Figures/Figure_5/figures/multiple_sweeps.pdf", g3, width = 4^a, height = 3^a)
library(devtools)
install.packages("devtools")
library(devtools)
install("~/Documents/MullerPlots/demonanalysis/")
library(demonanalysis)
subfolder_name <- "~/Documents/MullerPlots/" # insert name of top-level folder
input_dir <- paste0("00001DA3/", subfolder_name) # folder containing results of the batch
num_parameters <- count_parameters(input_dir) # number of simulation parameters (first columns in data)
input_dir <- paste0("~/Documents/MullerPlots/00001DA3/", subfolder_name) # folder containing results of the batch
num_parameters <- count_parameters(input_dir) # number of simulation parameters (first columns in data)
input_dir <- paste0("~/Documents/MullerPlots/", subfolder_name) # folder containing results of the batch
num_parameters <- count_parameters(input_dir) # number of simulation parameters (first columns in data)
input_dir <- "~/Documents/MullerPlots/00001DA3/"
num_parameters <- count_parameters(input_dir) # number of simulation parameters (first columns in data)
subfolder_name <- "00001DA3/" # insert name of top-level folder
input_dir <- paste0("~/Documents/MullerPlots/", subfolder_name) # folder containing results of the batch
num_parameters <- count_parameters(input_dir) # number of simulation parameters (first columns in data)
output_dir_plots <- paste0("plots/", subfolder_name) # folder to receive image files
output_dir_data <- paste0("data/", subfolder_name) # folder containing data files
all_statuses(input_dir, summary = TRUE) # should be "Exit code 0" (when finished) or "So far no status" (while running)
library(demonanalysis)
subfolder_name <- "00001DA3/" # insert name of top-level folder
input_dir <- paste0("~/Documents/MullerPlots/", subfolder_name) # folder containing results of the batch
num_parameters <- count_parameters(input_dir) # number of simulation parameters (first columns in data)
output_dir_plots <- paste0("plots/", subfolder_name) # folder to receive image files
output_dir_data <- paste0("data/", subfolder_name) # folder containing data files
all_statuses(input_dir, summary = TRUE) # should be "Exit code 0" (when finished) or "So far no status" (while running)
output_dir_data <- input_dir
output_dir_data <- input_dir
create_plots_batch(input_dir, output_dir = output_dir_plots, type = "chart", max_size = 50)
num_parameters
library(demonanalysis)
subfolder_name <- "00001DA3/" # insert name of top-level folder
input_dir <- paste0("~/Documents/MullerPlots/", subfolder_name) # folder containing results of the batch
all_statuses(input_dir, summary = TRUE) # should be "Exit code 0" (when finished) or "So far no status" (while running)
num_parameters <- count_parameters(input_dir) # number of simulation parameters (first columns in data)
output_dir_plots <- paste0("plots/", subfolder_name) # folder to receive image files
output_dir_data <- paste0("data/", subfolder_name) # folder containing data files
output_dir_data <- input_dir
create_plots_batch(input_dir, output_dir = output_dir_plots, type = "chart", max_size = 50)
create_plots_batch(input_dir, output_dir = output_dir_plots, type = "plot")
plot_all_images <- function(input_dir, output_filename = NA, file_type = "png", output_dir = NA, trim = -1, include_genotype_plots = TRUE,
cutoff = 0, min_birth_rate = NA, max_birth_rate = NA)
plot_all_images(input_dir)
plot_all_images(input_dir)
plot_all_images(input_dir)
rstudio_restart_r()
rstudio_reload()
